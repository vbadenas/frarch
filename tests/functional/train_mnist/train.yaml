# seeds
seed: 42
__set_seed: !apply:torch.manual_seed [!ref <seed>]
experiment_name: "mnist"
experiment_folder: "results/mnist_functional/"
device: "cpu"

# data folder
data_folder: /tmp/

# training parameters
epochs: 2
batch_size: 16
shuffle: True
num_clases: 10

transform_resize: !new:torchvision.transforms.Resize
    size: 32
transform_grayscale: !new:torchvision.transforms.Grayscale
    num_output_channels: 3
transform_tensor: !new:torchvision.transforms.ToTensor
transform_normalize: !new:torchvision.transforms.Normalize
    mean: 0.1307
    std: 0.3081

preprocessing: !new:torchvision.transforms.Compose
    transforms: [
        !ref <transform_resize>,
        !ref <transform_grayscale>,
        !ref <transform_tensor>,
        !ref <transform_normalize>
    ]

# dataset object
train_dataset: !new:torchvision.datasets.MNIST
    root: !ref <data_folder>
    train: true
    download: true
    transform: !ref <preprocessing>

valid_dataset: !new:torchvision.datasets.MNIST
    root: !ref <data_folder>
    train: false
    download: true
    transform: !ref <preprocessing>

# dataloader options
dataloader_options:
    batch_size: !ref <batch_size>
    shuffle: !ref <shuffle>
    num_workers: 8

opt_class: !name:torch.optim.Adam
    lr: 0.001

loss: !new:torch.nn.CrossEntropyLoss

model: !apply:torchvision.models.vgg11
    pretrained: false

modules:
    model: !ref <model>

checkpointer: !new:frarch.modules.Checkpointer
    save_path: !ref <experiment_folder>
    save_best_only: false
    modules: !ref <modules>
