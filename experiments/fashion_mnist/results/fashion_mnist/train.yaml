################################################
#                                              #
#  Model:                                      #
#  Author: vbadenas (victor.badenas@gmail.com) #
#                                              #
################################################

# seeds
seed: 42
__set_seed: !apply:torch.manual_seed [42]
experiment_name: fashion_mnist
device: cpu

# data folder
data_folder: ./data/

# training parameters
epochs: 10
batch_size: 128
shuffle: true

embedding_size: 128
num_clases: 10

transform_resize: &id001 !new:torchvision.transforms.Resize
  size: 32

transform_tensor: &id002 !new:torchvision.transforms.ToTensor

preprocessing: &id003 !new:torchvision.transforms.Compose

# dataloader options
  transforms: [*id001, *id002]

# dataset object
train_dataset: !new:torchvision.datasets.FashionMNIST
  root: ./data/
  train: true
  download: true
  transform: *id003
valid_dataset: !new:torchvision.datasets.FashionMNIST
  root: ./data/
  train: false
  download: true
  transform: *id003
dataloader_options:
  batch_size: 128
  shuffle: true
  num_workers: 0

opt_class: !name:torch.optim.Adam
  lr: 0.001

loss: !new:torch.nn.CrossEntropyLoss

error_metrics: !new:frarch.metrics.MetricsWrapper
  classification_error: !new:frarch.metrics.ClassificationError

model: &id004 !new:frarch.models.classification.cnn.FashionCNN
  out_size: 128

classifier: &id005 !new:frarch.models.classification.cnn.FashionClassifier
  embedding_size: 128
  classes: 10

modules:
  model: *id004
  classifier: *id005
debug: false
debug_batches: 2
noprogressbar: false
ckpt_interval_minutes:
log_file:
