################################################
#                                              #
#  Model:                                      #
#  Author: vbadenas (victor.badenas@gmail.com) #
#                                              #
################################################

# seeds
seed: 42
__set_seed: !apply:torch.manual_seed [!ref <seed>]
device: "cuda:0"

# data folder
data_folder: ./data/

# training parameters
epochs: 10
batch_size: 32
shuffle: True

transform_resize: !new:torchvision.transforms.Resize
    size: 32

transform_tensor: !new:torchvision.transforms.ToTensor

# dataset object
train_dataset: !new:torchvision.datasets.FashionMNIST
    root: !ref <data_folder>
    train: true
    download: true
    transform: 
        !new:torchvision.transforms.Compose
            transforms: [
                !ref <transform_resize>,
                !ref <transform_tensor>,
            ]

valid_dataset: !new:torchvision.datasets.FashionMNIST
    root: !ref <data_folder>
    train: false
    download: true

# dataloader options
dataloader_options:
    batch_size: !ref <batch_size>
    shuffle: !ref <shuffle>
    num_workers: 0

opt_class: !name:torch.optim.Adam
    lr: 0.001

loss: !new:torch.nn.CrossEntropyLoss

model: !new:frarch.models.classification.cnn.FashionCNN

modules:
    model: !ref <model>
